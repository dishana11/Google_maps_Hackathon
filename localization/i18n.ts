import { I18n } from 'i18n-js';
import * as Localization from 'expo-localization';
import { StorageService } from '../services/StorageService';

// Define helper functions first before they are used
export const getSupportedLanguageCodes = () => [
  'en', 'es', 'fr', 'de', 'it', 'pt', 'ru', 'zh', 'ja', 'ko', 'ar', 'hi', 'th', 'vi', 'tr', 'pl', 'nl', 'sv', 'da', 'no', 'fi', 'he', 'cs', 'sk', 'hu', 'ro', 'bg', 'hr', 'sr', 'sl', 'et', 'lv', 'lt', 'uk', 'be', 'mk', 'sq', 'mt', 'is', 'ga', 'cy', 'eu', 'ca', 'gl', 'fa', 'ur', 'bn', 'ta', 'te', 'ml', 'kn', 'gu', 'pa', 'or', 'as', 'mr', 'ne', 'si', 'my', 'km', 'lo', 'ka', 'hy', 'az', 'kk', 'ky', 'uz', 'tg', 'mn', 'bo', 'dz', 'am', 'ti', 'om', 'so', 'sw', 'zu', 'xh', 'af', 'st', 'tn', 'ss', 've', 'ts', 'nr', 'nso', 'mg', 'ny', 'sn', 'rw', 'rn', 'lg', 'wo', 'yo', 'ig', 'ha', 'ff', 'bm'
];

export const getSupportedLanguages = () => [
  { code: 'en', name: 'English', nativeName: 'English' },
  { code: 'es', name: 'Spanish', nativeName: 'Español' },
  { code: 'fr', name: 'French', nativeName: 'Français' },
  { code: 'de', name: 'German', nativeName: 'Deutsch' },
  { code: 'it', name: 'Italian', nativeName: 'Italiano' },
  { code: 'pt', name: 'Portuguese', nativeName: 'Português' },
  { code: 'ru', name: 'Russian', nativeName: 'Русский' },
  { code: 'zh', name: 'Chinese', nativeName: '中文' },
  { code: 'ja', name: 'Japanese', nativeName: '日本語' },
  { code: 'ko', name: 'Korean', nativeName: '한국어' },
  { code: 'ar', name: 'Arabic', nativeName: 'العربية' },
  { code: 'hi', name: 'Hindi', nativeName: 'हिन्दी' },
  { code: 'th', name: 'Thai', nativeName: 'ไทย' },
  { code: 'vi', name: 'Vietnamese', nativeName: 'Tiếng Việt' },
  { code: 'tr', name: 'Turkish', nativeName: 'Türkçe' },
  { code: 'pl', name: 'Polish', nativeName: 'Polski' },
  { code: 'nl', name: 'Dutch', nativeName: 'Nederlands' },
  { code: 'sv', name: 'Swedish', nativeName: 'Svenska' },
  { code: 'da', name: 'Danish', nativeName: 'Dansk' },
  { code: 'no', name: 'Norwegian', nativeName: 'Norsk' },
  { code: 'fi', name: 'Finnish', nativeName: 'Suomi' },
  { code: 'he', name: 'Hebrew', nativeName: 'עברית' },
  { code: 'cs', name: 'Czech', nativeName: 'Čeština' },
  { code: 'sk', name: 'Slovak', nativeName: 'Slovenčina' },
  { code: 'hu', name: 'Hungarian', nativeName: 'Magyar' },
  { code: 'ro', name: 'Romanian', nativeName: 'Română' },
  { code: 'bg', name: 'Bulgarian', nativeName: 'Български' },
  { code: 'hr', name: 'Croatian', nativeName: 'Hrvatski' },
  { code: 'sr', name: 'Serbian', nativeName: 'Српски' },
  { code: 'sl', name: 'Slovenian', nativeName: 'Slovenščina' },
  { code: 'et', name: 'Estonian', nativeName: 'Eesti' },
  { code: 'lv', name: 'Latvian', nativeName: 'Latviešu' },
  { code: 'lt', name: 'Lithuanian', nativeName: 'Lietuvių' },
  { code: 'uk', name: 'Ukrainian', nativeName: 'Українська' },
  { code: 'be', name: 'Belarusian', nativeName: 'Беларуская' },
  { code: 'mk', name: 'Macedonian', nativeName: 'Македонски' },
  { code: 'sq', name: 'Albanian', nativeName: 'Shqip' },
  { code: 'mt', name: 'Maltese', nativeName: 'Malti' },
  { code: 'is', name: 'Icelandic', nativeName: 'Íslenska' },
  { code: 'ga', name: 'Irish', nativeName: 'Gaeilge' },
  { code: 'cy', name: 'Welsh', nativeName: 'Cymraeg' },
  { code: 'eu', name: 'Basque', nativeName: 'Euskera' },
  { code: 'ca', name: 'Catalan', nativeName: 'Català' },
  { code: 'gl', name: 'Galician', nativeName: 'Galego' },
  { code: 'fa', name: 'Persian', nativeName: 'فارسی' },
  { code: 'ur', name: 'Urdu', nativeName: 'اردو' },
  { code: 'bn', name: 'Bengali', nativeName: 'বাংলা' },
  { code: 'ta', name: 'Tamil', nativeName: 'தமிழ்' },
  { code: 'te', name: 'Telugu', nativeName: 'తెలుగు' },
  { code: 'ml', name: 'Malayalam', nativeName: 'മലയാളം' },
  { code: 'kn', name: 'Kannada', nativeName: 'ಕನ್ನಡ' },
  { code: 'gu', name: 'Gujarati', nativeName: 'ગુજરાતી' },
  { code: 'pa', name: 'Punjabi', nativeName: 'ਪੰਜਾਬੀ' },
  { code: 'or', name: 'Odia', nativeName: 'ଓଡ଼ିଆ' },
  { code: 'as', name: 'Assamese', nativeName: 'অসমীয়া' },
  { code: 'mr', name: 'Marathi', nativeName: 'मराठी' },
  { code: 'ne', name: 'Nepali', nativeName: 'नेपाली' },
  { code: 'si', name: 'Sinhala', nativeName: 'සිංහල' },
  { code: 'my', name: 'Myanmar', nativeName: 'မြန်မာ' },
  { code: 'km', name: 'Khmer', nativeName: 'ខ្មែរ' },
  { code: 'lo', name: 'Lao', nativeName: 'ລາວ' },
  { code: 'ka', name: 'Georgian', nativeName: 'ქართული' },
  { code: 'hy', name: 'Armenian', nativeName: 'Հայերեն' },
  { code: 'az', name: 'Azerbaijani', nativeName: 'Azərbaycan' },
  { code: 'kk', name: 'Kazakh', nativeName: 'Қазақ' },
  { code: 'ky', name: 'Kyrgyz', nativeName: 'Кыргыз' },
  { code: 'uz', name: 'Uzbek', nativeName: 'Oʻzbek' },
  { code: 'tg', name: 'Tajik', nativeName: 'Тоҷикӣ' },
  { code: 'mn', name: 'Mongolian', nativeName: 'Монгол' },
  { code: 'bo', name: 'Tibetan', nativeName: 'བོད་ཡིག' },
  { code: 'dz', name: 'Dzongkha', nativeName: 'རྫོང་ཁ' },
  { code: 'am', name: 'Amharic', nativeName: 'አማርኛ' },
  { code: 'ti', name: 'Tigrinya', nativeName: 'ትግርኛ' },
  { code: 'om', name: 'Oromo', nativeName: 'Oromoo' },
  { code: 'so', name: 'Somali', nativeName: 'Soomaali' },
  { code: 'sw', name: 'Swahili', nativeName: 'Kiswahili' },
  { code: 'zu', name: 'Zulu', nativeName: 'isiZulu' },
  { code: 'xh', name: 'Xhosa', nativeName: 'isiXhosa' },
  { code: 'af', name: 'Afrikaans', nativeName: 'Afrikaans' },
  { code: 'st', name: 'Sesotho', nativeName: 'Sesotho' },
  { code: 'tn', name: 'Setswana', nativeName: 'Setswana' },
  { code: 'ss', name: 'Swati', nativeName: 'siSwati' },
  { code: 've', name: 'Venda', nativeName: 'Tshivenḓa' },
  { code: 'ts', name: 'Tsonga', nativeName: 'Xitsonga' },
  { code: 'nr', name: 'Ndebele', nativeName: 'isiNdebele' },
  { code: 'nso', name: 'Northern Sotho', nativeName: 'Sepedi' },
  { code: 'mg', name: 'Malagasy', nativeName: 'Malagasy' },
  { code: 'ny', name: 'Chichewa', nativeName: 'Chichewa' },
  { code: 'sn', name: 'Shona', nativeName: 'chiShona' },
  { code: 'rw', name: 'Kinyarwanda', nativeName: 'Kinyarwanda' },
  { code: 'rn', name: 'Kirundi', nativeName: 'Kirundi' },
  { code: 'lg', name: 'Luganda', nativeName: 'Luganda' },
  { code: 'wo', name: 'Wolof', nativeName: 'Wolof' },
  { code: 'yo', name: 'Yoruba', nativeName: 'Yorùbá' },
  { code: 'ig', name: 'Igbo', nativeName: 'Igbo' },
  { code: 'ha', name: 'Hausa', nativeName: 'Hausa' },
  { code: 'ff', name: 'Fulah', nativeName: 'Fulfulde' },
  { code: 'bm', name: 'Bambara', nativeName: 'Bamanankan' },
];

// Helper function to validate and normalize locale
const normalizeLocale = (locale: string | undefined): string => {
  if (!locale || typeof locale !== 'string') {
    return 'en';
  }
  
  // Extract language code from locale (e.g., 'en-US' -> 'en')
  const languageCode = locale.split('-')[0].toLowerCase();
  
  // Check if we support this language
  const supportedLanguages = getSupportedLanguageCodes();
  
  return supportedLanguages.includes(languageCode) ? languageCode : 'en';
};

const i18n = new I18n({
  en: {
    // Common
    common: {
      save: 'Save',
      cancel: 'Cancel',
      delete: 'Delete',
      edit: 'Edit',
      add: 'Add',
      remove: 'Remove',
      ok: 'OK',
      yes: 'Yes',
      no: 'No',
      loading: 'Loading...',
      error: 'Error',
      success: 'Success',
      warning: 'Warning',
      emergency: 'Emergency',
      location: 'Location',
      settings: 'Settings',
      profile: 'Profile',
      contacts: 'Contacts',
    },

    // Navigation
    navigation: {
      emergency: 'Emergency',
      private: 'Private',
      shared: 'Shared',
      contacts: 'Contacts',
      location: 'Location',
      settings: 'Settings',
      profile: 'Profile',
      emergencyAccess: 'Emergency Access',
    },

    // Emergency
    emergency: {
      title: 'SafeTravel',
      subtitle: 'Your personal safety companion for secure travel',
      emergencySOS: 'Emergency SOS',
      instruction: 'Press and hold for emergency assistance',
      activating: 'Activating...',
      active: 'Emergency Active',
      endEmergency: 'End Emergency',
      voiceActive: '🎤 Voice commands active',
      howItWorks: 'How it works:',
      step1: 'Press the emergency button, use voice command, or automatic speed detection',
      step2: 'Your emergency contacts are automatically notified via WhatsApp',
      step3: 'Location tracking starts and photos/videos can be captured',
      step4: 'All data is securely stored and shared with your trusted contacts',
    },

    // Quick Share
    quickShare: {
      shareNow: 'Share Now',
      quickText: 'Quick Text',
      quickPhoto: 'Quick Photo',
      quickVoice: 'Quick Voice',
      addDetails: 'Add Details',
      title: 'Title',
      description: 'Description',
      shareContent: 'Share Content',
      contentShared: 'Content shared successfully!',
      textPlaceholder: 'Type your safety note...',
      titlePlaceholder: 'Enter title (optional)',
      descriptionPlaceholder: 'Add description (optional)',
    },

    // Settings
    settings: {
      title: 'Settings',
      subtitle: 'Configure your safety preferences and emergency settings',
      voiceCommands: 'Voice Commands',
      voiceActivation: 'Voice Activation',
      voiceActivationDesc: 'Enable voice commands to trigger emergency mode',
      voiceCommandPhrase: 'Voice Command Phrase',
      voiceCommandHelp: 'Say this phrase to activate emergency mode',
      recordVoiceCommand: 'Record Voice Command',
      recordVoiceDesc: 'Record your voice for better recognition accuracy',
      mediaCapture: 'Media Capture',
      autoPhotoCapture: 'Auto Photo Capture',
      autoPhotoCaptureDesc: 'Automatically take photos during emergency',
      autoVideoRecording: 'Auto Video Recording',
      autoVideoRecordingDesc: 'Automatically record video during emergency',
      locationPrivacy: 'Location & Privacy',
      locationSharing: 'Location Sharing',
      locationSharingDesc: 'Share your location with emergency contacts',
      dataRetention: 'Data Retention',
      dataRetentionDesc: 'Days to keep emergency data',
      emergencyMode: 'Emergency Mode',
      emergencyModeDesc: 'Enhanced security and reduced functionality',
      appearance: 'Appearance',
      theme: 'Theme',
      themeDesc: 'Choose your preferred theme',
      language: 'Language',
      languageDesc: 'Select your preferred language',
      dataManagement: 'Data Management',
      clearAllData: 'Clear All Data',
      clearDataDesc: 'This will permanently delete all emergency sessions, location data, and media files.',
      clearDataWarning: 'This will permanently delete all emergency sessions, location data, and media. This action cannot be undone.',
      dataCleared: 'All data has been cleared',
    },

    // Themes
    themes: {
      light: 'Light',
      dark: 'Dark',
      system: 'System',
    },

    // Languages
    languages: {
      en: 'English',
      es: 'Español',
      fr: 'Français',
      de: 'Deutsch',
      it: 'Italiano',
      pt: 'Português',
      ru: 'Русский',
      zh: '中文',
      ja: '日本語',
      ko: '한국어',
      ar: 'العربية',
      hi: 'हिन्दी',
      th: 'ไทย',
      vi: 'Tiếng Việt',
      tr: 'Türkçe',
      pl: 'Polski',
      nl: 'Nederlands',
      sv: 'Svenska',
      da: 'Dansk',
      no: 'Norsk',
      fi: 'Suomi',
      he: 'עברית',
      cs: 'Čeština',
      sk: 'Slovenčina',
      hu: 'Magyar',
      ro: 'Română',
      bg: 'Български',
      hr: 'Hrvatski',
      sr: 'Српски',
      sl: 'Slovenščina',
      et: 'Eesti',
      lv: 'Latviešu',
      lt: 'Lietuvių',
      uk: 'Українська',
      be: 'Беларуская',
      mk: 'Македонски',
      sq: 'Shqip',
      mt: 'Malti',
      is: 'Íslenska',
      ga: 'Gaeilge',
      cy: 'Cymraeg',
      eu: 'Euskera',
      ca: 'Català',
      gl: 'Galego',
      fa: 'فارسی',
      ur: 'اردو',
      bn: 'বাংলা',
      ta: 'தமிழ்',
      te: 'తెలుగు',
      ml: 'മലയാളം',
      kn: 'ಕನ್ನಡ',
      gu: 'ગુજરાતી',
      pa: 'ਪੰਜਾਬੀ',
      or: 'ଓଡ଼ିଆ',
      as: 'অসমীয়া',
      mr: 'मराठी',
      ne: 'नेपाली',
      si: 'සිංහල',
      my: 'မြန်မာ',
      km: 'ខ្មែរ',
      lo: 'ລາວ',
      ka: 'ქართული',
      hy: 'Հայերեն',
      az: 'Azərbaycan',
      kk: 'Қазақ',
      ky: 'Кыргыз',
      uz: 'Oʻzbek',
      tg: 'Тоҷикӣ',
      mn: 'Монгол',
      bo: 'བོད་ཡིག',
      dz: 'རྫོང་ཁ',
      am: 'አማርኛ',
      ti: 'ትግርኛ',
      om: 'Oromoo',
      so: 'Soomaali',
      sw: 'Kiswahili',
      zu: 'isiZulu',
      xh: 'isiXhosa',
      af: 'Afrikaans',
      st: 'Sesotho',
      tn: 'Setswana',
      ss: 'siSwati',
      ve: 'Tshivenḓa',
      ts: 'Xitsonga',
      nr: 'isiNdebele',
      nso: 'Sepedi',
      mg: 'Malagasy',
      ny: 'Chichewa',
      sn: 'chiShona',
      rw: 'Kinyarwanda',
      rn: 'Kirundi',
      lg: 'Luganda',
      wo: 'Wolof',
      yo: 'Yorùbá',
      ig: 'Igbo',
      ha: 'Hausa',
      ff: 'Fulfulde',
      bm: 'Bamanankan',
    },

    // Contacts
    contacts: {
      title: 'Emergency Contacts',
      subtitle: 'Manage your trusted contacts for emergency situations',
      searchPlaceholder: 'Search contacts...',
      addFirstContact: 'Add Your First Contact',
      noContacts: 'No emergency contacts added yet',
      noContactsFound: 'No contacts found',
      addContact: 'Add Emergency Contact',
      editContact: 'Edit Contact',
      name: 'Name',
      phone: 'Phone',
      email: 'Email',
      whatsapp: 'WhatsApp Number',
      relationship: 'Relationship',
      primaryContact: 'Primary contact',
      countryCode: 'Country Code',
      phoneNumber: 'Phone Number',
      required: 'Required',
      optional: 'Optional',
      relationshipPlaceholder: 'e.g., Mother, Partner, Friend',
      fillAllFields: 'Please fill in all required fields',
      contactSaved: 'Contact saved successfully',
      deleteContact: 'Delete Contact',
      deleteContactConfirm: 'Are you sure you want to delete this emergency contact?',
    },
  },

  es: {
    // Common
    common: {
      save: 'Guardar',
      cancel: 'Cancelar',
      delete: 'Eliminar',
      edit: 'Editar',
      add: 'Agregar',
      remove: 'Quitar',
      ok: 'OK',
      yes: 'Sí',
      no: 'No',
      loading: 'Cargando...',
      error: 'Error',
      success: 'Éxito',
      warning: 'Advertencia',
      emergency: 'Emergencia',
      location: 'Ubicación',
      settings: 'Configuración',
      profile: 'Perfil',
      contacts: 'Contactos',
    },

    // Navigation
    navigation: {
      emergency: 'Emergencia',
      private: 'Privado',
      shared: 'Compartido',
      contacts: 'Contactos',
      location: 'Ubicación',
      settings: 'Configuración',
      profile: 'Perfil',
      emergencyAccess: 'Acceso de Emergencia',
    },

    // Emergency
    emergency: {
      title: 'SafeTravel',
      subtitle: 'Tu compañero personal de seguridad para viajes seguros',
      emergencySOS: 'SOS de Emergencia',
      instruction: 'Mantén presionado para asistencia de emergencia',
      activating: 'Activando...',
      active: 'Emergencia Activa',
      endEmergency: 'Terminar Emergencia',
      voiceActive: '🎤 Comandos de voz activos',
      howItWorks: 'Cómo funciona:',
      step1: 'Presiona el botón de emergencia, usa comando de voz o detección automática de velocidad',
      step2: 'Tus contactos de emergencia son notificados automáticamente vía WhatsApp',
      step3: 'El seguimiento de ubicación comienza y se pueden capturar fotos/videos',
      step4: 'Todos los datos se almacenan de forma segura y se comparten con tus contactos de confianza',
    },

    // Quick Share
    quickShare: {
      shareNow: 'Compartir Ahora',
      quickText: 'Texto Rápido',
      quickPhoto: 'Foto Rápida',
      quickVoice: 'Voz Rápida',
      addDetails: 'Agregar Detalles',
      title: 'Título',
      description: 'Descripción',
      shareContent: 'Compartir Contenido',
      contentShared: '¡Contenido compartido exitosamente!',
      textPlaceholder: 'Escribe tu nota de seguridad...',
      titlePlaceholder: 'Ingresa título (opcional)',
      descriptionPlaceholder: 'Agregar descripción (opcional)',
    },

    // Settings
    settings: {
      title: 'Configuración',
      subtitle: 'Configura tus preferencias de seguridad y configuración de emergencia',
      voiceCommands: 'Comandos de Voz',
      voiceActivation: 'Activación por Voz',
      voiceActivationDesc: 'Habilitar comandos de voz para activar modo de emergencia',
      voiceCommandPhrase: 'Frase de Comando de Voz',
      voiceCommandHelp: 'Di esta frase para activar el modo de emergencia',
      recordVoiceCommand: 'Grabar Comando de Voz',
      recordVoiceDesc: 'Graba tu voz para mejor precisión de reconocimiento',
      mediaCapture: 'Captura de Medios',
      autoPhotoCapture: 'Captura Automática de Fotos',
      autoPhotoCaptureDesc: 'Tomar fotos automáticamente durante emergencia',
      autoVideoRecording: 'Grabación Automática de Video',
      autoVideoRecordingDesc: 'Grabar video automáticamente durante emergencia',
      locationPrivacy: 'Ubicación y Privacidad',
      locationSharing: 'Compartir Ubicación',
      locationSharingDesc: 'Compartir tu ubicación con contactos de emergencia',
      dataRetention: 'Retención de Datos',
      dataRetentionDesc: 'Días para mantener datos de emergencia',
      emergencyMode: 'Modo de Emergencia',
      emergencyModeDesc: 'Seguridad mejorada y funcionalidad reducida',
      appearance: 'Apariencia',
      theme: 'Tema',
      themeDesc: 'Elige tu tema preferido',
      language: 'Idioma',
      languageDesc: 'Selecciona tu idioma preferido',
      dataManagement: 'Gestión de Datos',
      clearAllData: 'Borrar Todos los Datos',
      clearDataDesc: 'Esto eliminará permanentemente todas las sesiones de emergencia, datos de ubicación y archivos multimedia.',
      clearDataWarning: 'Esto eliminará permanentemente todas las sesiones de emergencia, datos de ubicación y medios. Esta acción no se puede deshacer.',
      dataCleared: 'Todos los datos han sido borrados',
    },

    // Themes
    themes: {
      light: 'Claro',
      dark: 'Oscuro',
      system: 'Sistema',
    },

    // Languages (same as English for now)
    languages: {
      en: 'English',
      es: 'Español',
      fr: 'Français',
      de: 'Deutsch',
      it: 'Italiano',
      pt: 'Português',
      ru: 'Русский',
      zh: '中文',
      ja: '日本語',
      ko: '한국어',
      ar: 'العربية',
      hi: 'हिन्दी',
      th: 'ไทย',
      vi: 'Tiếng Việt',
      tr: 'Türkçe',
      pl: 'Polski',
      nl: 'Nederlands',
      sv: 'Svenska',
      da: 'Dansk',
      no: 'Norsk',
      fi: 'Suomi',
      he: 'עברית',
      cs: 'Čeština',
      sk: 'Slovenčina',
      hu: 'Magyar',
      ro: 'Română',
      bg: 'Български',
      hr: 'Hrvatski',
      sr: 'Српски',
      sl: 'Slovenščina',
      et: 'Eesti',
      lv: 'Latviešu',
      lt: 'Lietuvių',
      uk: 'Українська',
      be: 'Беларуская',
      mk: 'Македонски',
      sq: 'Shqip',
      mt: 'Malti',
      is: 'Íslenska',
      ga: 'Gaeilge',
      cy: 'Cymraeg',
      eu: 'Euskera',
      ca: 'Català',
      gl: 'Galego',
      fa: 'فارسی',
      ur: 'اردو',
      bn: 'বাংলা',
      ta: 'தமிழ்',
      te: 'తెలుగు',
      ml: 'മലയാളം',
      kn: 'ಕನ್ನಡ',
      gu: 'ગુજરાતી',
      pa: 'ਪੰਜਾਬੀ',
      or: 'ଓଡ଼ିଆ',
      as: 'অসমীয়া',
      mr: 'मराठी',
      ne: 'नेपाली',
      si: 'සිංහල',
      my: 'မြန်မာ',
      km: 'ខ្មែរ',
      lo: 'ລາວ',
      ka: 'ქართული',
      hy: 'Հայերեն',
      az: 'Azərbaycan',
      kk: 'Қазақ',
      ky: 'Кыргыз',
      uz: 'Oʻzbek',
      tg: 'Тоҷикӣ',
      mn: 'Монгол',
      bo: 'བོད་ཡིག',
      dz: 'རྫོང་ཁ',
      am: 'አማርኛ',
      ti: 'ትግርኛ',
      om: 'Oromoo',
      so: 'Soomaali',
      sw: 'Kiswahili',
      zu: 'isiZulu',
      xh: 'isiXhosa',
      af: 'Afrikaans',
      st: 'Sesotho',
      tn: 'Setswana',
      ss: 'siSwati',
      ve: 'Tshivenḓa',
      ts: 'Xitsonga',
      nr: 'isiNdebele',
      nso: 'Sepedi',
      mg: 'Malagasy',
      ny: 'Chichewa',
      sn: 'chiShona',
      rw: 'Kinyarwanda',
      rn: 'Kirundi',
      lg: 'Luganda',
      wo: 'Wolof',
      yo: 'Yorùbá',
      ig: 'Igbo',
      ha: 'Hausa',
      ff: 'Fulfulde',
      bm: 'Bamanankan',
    },

    // Contacts
    contacts: {
      title: 'Contactos de Emergencia',
      subtitle: 'Gestiona tus contactos de confianza para situaciones de emergencia',
      searchPlaceholder: 'Buscar contactos...',
      addFirstContact: 'Agregar Tu Primer Contacto',
      noContacts: 'No se han agregado contactos de emergencia aún',
      noContactsFound: 'No se encontraron contactos',
      addContact: 'Agregar Contacto de Emergencia',
      editContact: 'Editar Contacto',
      name: 'Nombre',
      phone: 'Teléfono',
      email: 'Email',
      whatsapp: 'Número de WhatsApp',
      relationship: 'Relación',
      primaryContact: 'Contacto principal',
      countryCode: 'Código de País',
      phoneNumber: 'Número de Teléfono',
      required: 'Requerido',
      optional: 'Opcional',
      relationshipPlaceholder: 'ej., Madre, Pareja, Amigo',
      fillAllFields: 'Por favor completa todos los campos requeridos',
      contactSaved: 'Contacto guardado exitosamente',
      deleteContact: 'Eliminar Contacto',
      deleteContactConfirm: '¿Estás seguro de que quieres eliminar este contacto de emergencia?',
    },
  },

  // Add more languages as needed...
});

// When a value is missing from a language it'll fall back to another language with the key present
i18n.enableFallback = true;
i18n.defaultLocale = 'en';

export default i18n;

export const initializeI18n = async () => {
  try {
    const savedLanguage = await StorageService.getLanguage();
    if (savedLanguage && typeof savedLanguage === 'string') {
      const normalizedLanguage = normalizeLocale(savedLanguage);
      i18n.locale = normalizedLanguage;
    } else {
      // Set initial locale from device if no saved language
      const deviceLocale = Localization.locale || Localization.getLocales()?.[0]?.languageCode;
      i18n.locale = normalizeLocale(deviceLocale);
    }
  } catch (error) {
    console.error('Error loading saved language:', error);
    // Ensure we always have a valid locale
    i18n.locale = 'en';
  }
};

export const setLanguage = async (language: string) => {
  const normalizedLanguage = normalizeLocale(language);
  i18n.locale = normalizedLanguage;
  try {
    await StorageService.saveLanguage(normalizedLanguage);
  } catch (error) {
    console.error('Error saving language:', error);
  }
};

export const getCurrentLanguage = () => i18n.locale || 'en';
